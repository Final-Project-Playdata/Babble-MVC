import{c as e,a as t,C as r,u as a,o as s,b as l,d as o,w as i,v as n,e as d,f as c,g as u,r as b,F as p,h,i as m,j as f,t as g,k as v,l as y,m as x,n as w,p as k,q as C,s as U,x as M,y as A,z as R,A as E,B as L}from"./vendor.b887cc8f.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(r){const a=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((r,l)=>{const o=new URL(e,a);if(self[t].moduleMap[o])return r(self[t].moduleMap[o]);const i=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),n=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){l(new Error(`Failed to import: ${e}`)),s(n)},onload(){r(self[t].moduleMap[o]),s(n)}});document.head.appendChild(n)})),self[t].moduleMap={}}}("/assets/");const I=e({state:()=>({user:null,tags:null,token:null,username:null,password:null,checkedAudio:null,notifications:null,isCommentModal:!1,notificationInterval:null}),mutations:{SET_USER:(e,t)=>{e.user=t},CLEAR_DATA:e=>{e.user=null,e.tags=null,e.token=null,e.username=null,e.password=null,e.checkedAudio=null,e.notifications=null,e.isCommentModal=!1,clearInterval(e.notificationInterval),e.notificationInterval=null},SET_TOKEN(e,t){e.token=t},SET_CHECKEDAUDIO(e,t){e.checkedAudio=t},SET_USERNAME(e,t){e.username=t},SET_PASSWORD(e,t){e.password=t},SET_TAGS(e,t){e.tags=t},SET_ISCOMMENTMODAL(e,t){e.isCommentModal=t},SET_NOTIFICATIONINTERVAL(e,t){e.notificationInterval=t}},plugins:[t()]});function T(e){return S.post("/login",e)}function B(e){return r.create({baseURL:e})}function D(e){return function(e){return e.interceptors.request.use((function(e){return e.headers.Authorization=I.state.token,e}),(function(e){return Promise.reject(e)})),e.interceptors.response.use((function(e){return e}),(async function(t){const r=t.config;if(403===t.response.status&&!r._retry){if(console.log("토큰 만료"),r._retry=!0,I.state.username&&I.state.password){const t={username:I.state.username,password:I.state.password},a=await T(t);return a&&(await I.commit("SET_TOKEN",a.headers.authorization),r.headers.Authorization=I.state.token),e(r)}window.location.href="/"}return 500===t.response.status&&window.location.reload(),Promise.reject(t)})),e}(r.create({baseURL:e}))}const S=B("http://localhost:80"),z=B("http://localhost:5000"),F=D("http://localhost:80"),V=D("http://localhost:88"),P=B("http://localhost:9200"),_={headers:{"Content-Type":"application/json"}};function $(e){return P.post("notification/_doc",e,_)}function j(e){return P.get(`notification/_search?q=receiver:${e}&sort=timestamp:desc`,_)}function N(e,t){if(e.user.id!==t.id){$({sender:t.id,sender_avatar:t.avatar,receiver:e.user.id,babble:e.id,message:`${t.username}님이 회원님의 배블에 댓글을 달았습니다.`,timestamp:Date.now()})}}function O(e,t){if(e.user.id!==t.id){$({sender:t.id,sender_avatar:t.avatar,receiver:e.user.id,babble:e.id,message:`${t.username}님이 회원님의 배블을 리배블 했습니다.`,timestamp:Date.now()})}}function H(e,t){if(e.user.id!==t.id){console.log(t.id);$({sender:t.id,sender_avatar:t.avatar,receiver:e.user.id,babble:e.id,message:`${t.username}님이 회원님의 배블을 좋아합니다.`,timestamp:Date.now()})}}const K={data:function(){return{hashTag:"",router:a()}},methods:{search:function(){this.$data.router.replace(`/${this.$data.hashTag}`)}}},Q={class:"hidden lg:block lg:w-2/5 px-4 py-2"},Z={class:"relative mb-5"},W=o("i",{class:"fas fa-search absolute left-0 mt-2 ml-3 text-sm text-light"},null,-1),q=c('<div class="w-full rounded-xl bg-gray-50 flex flex-col"><div class="flex items-center justify-between px-3 py-1 border-b border-gray-100"><span class="text-lg font-bold">최근 내가 많이 사용한 단어들</span><i class="text-center fas fa-cog text-lg text-primary hover:bg-blue-50 p-2 rounded-full w-10 h-10"></i></div><br><iframe src="http://localhost:5601/app/dashboards#/view/1a09ac70-a343-11eb-b490-43c22c963dbd?embed=true&amp;_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!f%2Cvalue%3A10000)%2Ctime%3A(from%3Anow-1h%2Cto%3Anow))&amp;hide-filter-bar=true" height="380"></iframe></div><div class="mt-5 w-full rounded-xl bg-gray-50 flex flex-col"><div class="px-3 py-3 border-b border-gray-100"><span class="text-lg font-bold">최근 나의 상태</span></div><iframe src="http://localhost:5601/app/dashboards#/view/c31e20c0-a343-11eb-b490-43c22c963dbd?embed=true&amp;_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!f%2Cvalue%3A10000)%2Ctime%3A(from%3Anow-1h%2Cto%3Anow))&amp;hide-filter-bar=true" height="490"></iframe></div>',2);K.render=function(e,t,r,a,c,u){return s(),l("div",Q,[o("div",Z,[i(o("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.hashTag=t),onKeyup:t[2]||(t[2]=d(((...e)=>u.search&&u.search(...e)),["enter"])),placeholder:"Hash Tag",type:"text",class:"pl-10 rounded-full w-full p-2 bg-gray-100 text-sm focus:ring-1 focus:ring-primary focus:bg-white focus:outline-none"},null,544),[[n,e.hashTag]]),W]),q])};const X={components:{Trends:K},setup:()=>({currentUser:u((()=>I.state.user)),notifications:u((()=>I.state.notifications))})},Y={class:"flex-1 border-r border-gray-100 flex flex-col overflow-y-auto"},G=o("div",{class:"p-3 font-bold text-lg border-b border-gray-100"},"알림",-1),J={class:"flex justify-between"},ee=o("i",{class:"fas fa-ellipsis-h text-gray-500 hover:bg-blue-50 hover:text-primary p-2 rounded-full w-10 h-10 flex items-center justify-center"},null,-1);X.render=function(e,t,r,a,i,n){const d=b("router-link"),c=b("Trends");return s(),l(p,null,[o("div",Y,[G,(s(!0),l(p,null,h(a.notifications,(e=>(s(),l("div",{class:"flex flex-col hover:bg-gray-50 p-3 space-y-2 border-b border-gray-100 cursor-pointer",key:e.sender_id},[o("div",J,[o(d,{to:`/profile/${e._source.sender}`},{default:m((()=>[o("img",{src:e._source.sender_avatar,class:"w-10 h-10 rounded-full hover:opacity-80"},null,8,["src"])])),_:2},1032,["to"]),ee]),e._source.babble?(s(),l(d,{key:0,to:`/babble/${e._source.babble}`,class:"font-bold"},{default:m((()=>[f(g(e._source.message),1)])),_:2},1032,["to"])):(s(),l(d,{key:1,to:`/profile/${e._source.sender}`,class:"font-bold"},{default:m((()=>[f(g(e._source.message),1)])),_:2},1032,["to"]))])))),128))]),o(c)],64)};const te={setup(){const e=v(""),t=v(""),r=v(""),s=v(""),l=v(""),o=v(!1),i=a();return{onRegister:async()=>{if(!(e.value&&t.value&&r.value&&s.value&&l.value))return void alert("빈칸을 모두 입력해주세요.");var a;if(!(a=e.value,/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(a).toLowerCase())))return void alert("이메일 형식이 맞지 않습니다.");o.value=!0;!function(e){S.post("/signup",e)}({username:e.value,nickname:t.value,firstName:r.value,lastName:s.value,password:l.value}),o.value=!1,i.push("/login")},firstName:r,username:e,nickname:t,lastName:s,password:l,loading:o}}},re={class:"flex flex-col items-center space-y-4 mt-10"},ae=f("   "),se=o("br",null,null,-1),le=o("img",{src:"/assets/6.3545caac.jpg",width:"300",height:"300",class:"text-4xl text-primary"},null,-1),oe=o("span",{class:"text-2xl font-bold"},"회원가입",-1),ie={key:0,class:"w-96 rounded bg-light text-white py-3"},ne=o("button",{class:"text-primary"},"계정이 이미 있으신가요? 로그인 하기",-1);te.render=function(e,t,r,a,c,u){const p=b("router-link");return s(),l("div",re,[ae,se,le,oe,i(o("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.username=e),type:"text",class:"rounded w-96 px-4 py-3 border border-gray-300 focus:ring-2 focus:border-primary focus:outline-none",placeholder:"이메일"},null,512),[[n,a.username]]),i(o("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.nickname=e),type:"text",class:"rounded w-96 px-4 py-3 border border-gray-300 focus:ring-2 focus:border-primary focus:outline-none",placeholder:"닉네임"},null,512),[[n,a.nickname]]),i(o("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.firstName=e),type:"text",class:"rounded w-96 px-4 py-3 border border-gray-300 focus:ring-2 focus:border-primary focus:outline-none",placeholder:"이름"},null,512),[[n,a.firstName]]),i(o("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>a.lastName=e),type:"text",class:"rounded w-96 px-4 py-3 border border-gray-300 focus:ring-2 focus:border-primary focus:outline-none",placeholder:"성"},null,512),[[n,a.lastName]]),i(o("input",{onKeyup:t[5]||(t[5]=d(((...e)=>a.onRegister&&a.onRegister(...e)),["enter"])),"onUpdate:modelValue":t[6]||(t[6]=e=>a.password=e),type:"password",class:"rounded w-96 px-4 py-3 border border-gray-300 focus:ring-2 focus:border-primary focus:outline-none",placeholder:"비밀번호"},null,544),[[n,a.password]]),a.loading?(s(),l("button",ie," 회원가입 중입니다. ")):(s(),l("button",{key:1,class:"w-96 rounded bg-primary text-white py-3 hover:bg-dark",onClick:t[7]||(t[7]=(...e)=>a.onRegister&&a.onRegister(...e))}," 회원가입 ")),o(p,{to:"/login"},{default:m((()=>[ne])),_:1})])};const de={headers:{"Content-Type":"multipart/form-data"}};function ce(e){return V.post("image",e,de)}const ue={setup({emit:e}){const t=v(null),r=v(null),a=v(null),s=v(null),l=()=>{const e=new Date;if(e.getMonth()+1<10){return`${I.state.user.username}.${e.getFullYear()}-0${e.getMonth()+1}-${e.getDate()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}-${e.getMilliseconds()}.jpeg`}return`${I.state.user.username}.${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}-${e.getMilliseconds()}.jpeg`};return{onChangeBackgroundImage:()=>{document.getElementById("backgroundImageInput").click()},previewBackgroundImage:e=>{const t=e.target.files[0];s.value=new File([t],l(),{type:t.type,lastModified:t.lastModified});const r=new FileReader;r.onload=function(e){a.value.src=e.target.result},r.readAsDataURL(t)},onChangeProfileImage:()=>{document.getElementById("profileImageInput").click()},previewProfileImage:async e=>{const a=e.target.files[0];r.value=new File([a],l(),{type:a.type,lastModified:a.lastModified});const s=new FileReader;s.onload=function(e){t.value.src=e.target.result},s.readAsDataURL(a)},backgroundImageData:s,profileImageData:r,backgroundImage:a,onSaveProfile:()=>{const t=I.state.user;if(r.value){t.avatar=r.value.name;const e=new FormData;e.append("image",r.value),ce(e)}else t.avatar=t.avatar.slice(26);if(s.value){t.background=s.value.name;const e=new FormData;e.append("image",s.value),ce(e)}else t.background=t.background.slice(26);var a;a=t,F.put(`user/${a.id}`,a),e("close-modal")},profileImage:t}}},be={class:"flex justify-center min-h-screen sm:pt-6 sm:px-4 sm:pb-20 text-center sm:block sm:p-0"},pe=o("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[o("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1),he={class:"border-b border-gray-100 p-2 flex items-center justify-between"},me={class:"flex items-center"},fe=o("span",{class:"font-bold text-lg"},"프로필 수정",-1),ge={class:"text-right mr-2"},ve={class:"h-60"},ye={class:"bg-gray-300 h-40 relative flex-none flex items-center justify-center"},xe={class:"flex flex-col p-2"},we={class:"mx-2 my-1 px-2 py-1 border text-gray border-gray-200 rounded hover:border-primary hover:text-primary"},ke={class:"mx-2 my-1 px-2 py-1 border text-gray border-gray-200 rounded hover:border-primary hover:text-primary"},Ce={class:"mx-2 my-1 px-2 py-1 border text-gray border-gray-200 rounded hover:border-primary hover:text-primary"},Ue={class:"mx-2 my-1 px-2 py-1 border text-gray border-gray-200 rounded hover:border-primary hover:text-primary"},Me={class:"mx-2 my-1 px-2 py-5 border text-gray border-gray-200 rounded hover:border-primary hover:text-primary"},Ae={class:"mx-2 my-1 px-2 py-3 border text-gray border-gray-200 rounded hover:border-primary hover:text-primary"},Re=o("option",{value:"male"},"Male",-1),Ee=o("option",{value:"female"},"Female",-1),Le=o("option",{value:"whatever"},"Whatever",-1),Ie={class:"mx-2 my-1 px-2 py-3 border text-gray border-gray-200 rounded hover:border-primary hover:text-primary"};ue.render=function(e,t,r,a,d,c){return s(),l("div",{class:"fixed z-10 inset-0 overflow-y-auto",onClick:t[15]||(t[15]=t=>e.$emit("close-modal"))},[o("div",be,[pe,o("div",{onClick:t[14]||(t[14]=y((()=>{}),["stop"])),class:"inline-block bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg w-full",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},[o("div",he,[o("div",me,[o("button",{onClick:t[1]||(t[1]=t=>e.$emit("close-modal")),class:"flex items-center justify-center fas fa-times text-primary text-lg p-2 h-10 w-10 hover:bg-blue-50 rounded-full"}),fe]),o("div",ge,[o("button",{onClick:t[2]||(t[2]=(...e)=>a.onSaveProfile&&a.onSaveProfile(...e)),class:"hover:bg-dark bg-primary text-white font-bold px-3 py-1 rounded-full"}," 저장 ")])]),o("div",ve,[o("div",ye,[o("img",{ref:"backgroundImage",src:e.$store.state.user.background,class:"object-cover absolute h-full w-full"},null,8,["src"]),o("button",{onClick:t[3]||(t[3]=(...e)=>a.onChangeBackgroundImage&&a.onChangeBackgroundImage(...e)),class:"absolute h-10 w-10 hover:text-gray-200 rounded-full fas fa-camera text-white text-lg"}),o("input",{onChange:t[4]||(t[4]=(...e)=>a.previewBackgroundImage&&a.previewBackgroundImage(...e)),type:"file",accept:"image/*",id:"backgroundImageInput",class:"hidden"},null,32),o("img",{ref:"profileImage",src:e.$store.state.user.avatar,class:"border-4 border-white w-28 h-28 absolute -bottom-14 left-2 rounded-full"},null,8,["src"]),o("button",{onClick:t[5]||(t[5]=(...e)=>a.onChangeProfileImage&&a.onChangeProfileImage(...e)),class:"absolute -bottom-5 left-11 h-10 w-10 hover:text-gray-200 rounded-full fas fa-camera text-white text-lg"}),o("input",{onChange:t[6]||(t[6]=(...e)=>a.previewProfileImage&&a.previewProfileImage(...e)),type:"file",accept:"image/*",id:"profileImageInput",class:"hidden"},null,32)])]),o("div",xe,[o("div",we,[i(o("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=t=>e.$store.state.user.nickname=t),placeholder:"닉네임",class:"text-black focus:outline-none"},null,512),[[n,e.$store.state.user.nickname]])]),o("div",ke,[i(o("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=t=>e.$store.state.user.bio=t),placeholder:"한줄소개",class:"text-black focus:outline-none"},null,512),[[n,e.$store.state.user.bio]])]),o("div",Ce,[i(o("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=t=>e.$store.state.user.firstName=t),placeholder:"이름",class:"text-black focus:outline-none"},null,512),[[n,e.$store.state.user.firstName]])]),o("div",Ue,[i(o("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=t=>e.$store.state.user.lastName=t),placeholder:"성",class:"text-black focus:outline-none"},null,512),[[n,e.$store.state.user.lastName]])]),o("div",Me,[i(o("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=t=>e.$store.state.user.phoneNumber=t),placeholder:"핸드폰 번호",class:"text-black focus:outline-none"},null,512),[[n,e.$store.state.user.phoneNumber]])]),o("div",Ae,[i(o("select",{"onUpdate:modelValue":t[12]||(t[12]=t=>e.$store.state.user.gender=t)},[Re,Ee,Le],512),[[x,e.$store.state.user.gender]])]),o("div",Ie,[i(o("input",{type:"date",placeholder:"생년월일","onUpdate:modelValue":t[13]||(t[13]=t=>e.$store.state.user.birth=t),class:"text-black focus:outline-none"},null,512),[[n,e.$store.state.user.birth]])])])])])])};const Te={props:["audioUrl"],data:function(){return{isPlaying:!1,isLoaded:!1,audio:""}},watch:{$route(){this.audio&&(this.audio.pause(),this.audio=null)}},methods:{async play(){this.isLoaded||(this.audio=new Audio(`http://localhost:88/audio/${this.audioUrl}`),this.isLoaded=!0),this.isPlaying?(this.audio.pause(),this.isPlaying=!1):(this.audio.play(),this.isPlaying=!0)}}};function Be(e){return F.delete(`/babble/${e}`)}function De(e){return F.post("rebabble",e)}function Se(e){return F.post(`babble/${e}/like`)}function ze(e){return F.delete(`babble/${e}/like`)}Te.render=function(e,t,r,a,o,i){return s(),l("div",{onClick:t[1]||(t[1]=e=>i.play())},"Listen Babble")};const Fe={props:{name:{type:String}},data:function(){return{icons:{mic:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',cancel:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/><path d="M14 3v5h5M9.9 17.1L14 13M9.9 12.9L14 17"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>',stop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 6h12v12H6z"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'}}}};function Ve(e,t){const r=t.getBoundingClientRect().width,a=e.target.getBoundingClientRect().left;let s=(e.clientX-a)/r;try{if(!e.target.className.match(/^ar\-line\-control/))return}catch(l){return}return s=s<0?0:s,s=s>1?1:s,s}function Pe(e){return new Date(1e3*e).toISOString().substr(14,5)}Fe.render=function(e,t,r,a,o,i){return s(),l("div",{innerHTML:e.icons[r.name]},null,8,["innerHTML"])};const _e={props:{refId:{type:String},eventName:{type:String},percentage:{type:Number,default:0},rowDirection:{type:Boolean,default:!0}},methods:{onMouseDown(e){const t=Ve(e,this.$refs[this.refId]);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=Ve(e,this.$refs[this.refId]);this.$emit("change-linehead",t)},onMouseMove(e){const t=Ve(e,this.$refs[this.refId]);this.$emit("change-linehead",t)}},computed:{calculateSize(){const e=this.percentage<1?100*this.percentage:this.percentage;return`${this.rowDirection?"width":"height"}: ${e}%`}}};_e.render=function(e,t,r,a,i,n){return s(),l("div",{ref:r.refId,class:"ar-line-control",onMousedown:t[1]||(t[1]=(...e)=>n.onMouseDown&&n.onMouseDown(...e))},[o("div",{class:"ar-line-control__head",style:n.calculateSize},null,4)],544)};const $e={data:()=>({volume:.8}),components:{IconButton:Fe,LineControl:_e},methods:{onChangeLinehead(e){this.$emit("change-volume",e),this.volume=e}}},je={class:"ar-volume"};$e.render=function(e,t,r,a,i,n){const d=b("icon-button"),c=b("line-control");return s(),l("div",je,[o(d,{class:"ar-volume__icon",name:"volume"}),o(c,{class:"ar-volume-bar","ref-id":"volume",percentage:i.volume,onChangeLinehead:n.onChangeLinehead},null,8,["percentage","onChangeLinehead"])])};const Ne={props:{src:{type:String},filename:{type:String}},data:()=>({isPlaying:!1,duration:Pe(0),playedTime:Pe(0),progress:0}),components:{IconButton:Fe,LineControl:_e,VolumeControl:$e},mounted:function(){this.player=document.getElementById(this.playerUniqId),this.player.addEventListener("ended",(()=>{this.isPlaying=!1})),this.player.addEventListener("loadeddata",(e=>{this._resetProgress(),this.duration=Pe(this.player.duration)})),this.player.addEventListener("timeupdate",this._onTimeUpdate)},computed:{audioSource(){const e=this.src;if(e)return e;this._resetProgress()},playBtnIcon(){return this.isPlaying?"pause":"play"},playerUniqId(){return`audio-player${this._uid}`}},methods:{playback(){this.audioSource&&(this.isPlaying?this.player.pause():setTimeout((()=>{this.player.play()}),0),this.isPlaying=!this.isPlaying)},_resetProgress(){this.isPlaying&&this.player.pause(),this.duration=Pe(0),this.playedTime=Pe(0),this.progress=0,this.isPlaying=!1},_onTimeUpdate(){this.playedTime=Pe(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100},_onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},_onChangeVolume(e){e&&(this.player.volume=e)}}},Oe={class:"ar-player"},He={class:"ar-player-actions"},Ke=f("  "),Qe=o("br",null,null,-1),Ze={class:"ar-player-bar"},We={class:"ar-player__time"},qe={class:"ar-player__time"},Xe=f("  "),Ye=o("br",null,null,-1);Ne.render=function(e,t,r,a,i,n){const d=b("icon-button"),c=b("line-control"),u=b("volume-control"),p=b("center");return s(),l(p,null,{default:m((()=>[o("div",Oe,[o("div",He,[o(d,{id:"play",class:["ar-icon ar-icon__lg ar-player__play",{"ar-player__play--active":i.isPlaying}],name:n.playBtnIcon,onClick:n.playback},null,8,["name","class","onClick"])]),Ke,Qe,o("div",Ze,[o("div",We,g(i.playedTime),1),o(c,{class:"ar-player__progress","ref-id":"progress",percentage:i.progress,onChangeLinehead:n._onUpdateProgress},null,8,["percentage","onChangeLinehead"]),o("div",qe,g(i.duration),1),o(u,{onChangeVolume:n._onChangeVolume},null,8,["onChangeVolume"])]),Xe,Ye,o("audio",{id:n.playerUniqId,src:n.audioSource},null,8,["id","src"])])])),_:1})};class Ge{constructor(e){this.bufferSize=e.bufferSize||4096,this.sampleRate=e.sampleRate,this.samples=e.samples}finish(){this._joinSamples();let e=new ArrayBuffer(44+2*this.samples.length),t=new DataView(e);this._writeString(t,0,"RIFF"),t.setUint32(4,36+2*this.samples.length,!0),this._writeString(t,8,"WAVE"),this._writeString(t,12,"fmt "),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,1,!0),t.setUint32(24,this.sampleRate,!0),t.setUint32(28,4*this.sampleRate,!0),t.setUint16(32,4,!0),t.setUint16(34,16,!0),this._writeString(t,36,"data"),t.setUint32(40,2*this.samples.length,!0),this._floatTo16BitPCM(t,44,this.samples);const r=new Blob([t],{type:"audio/wav"});return{id:Date.now(),blob:r,url:URL.createObjectURL(r)}}_floatTo16BitPCM(e,t,r){for(let a=0;a<r.length;a++,t+=2){let s=Math.max(-1,Math.min(1,r[a]));e.setInt16(t,s<0?32768*s:32767*s,!0)}}_joinSamples(){let e=this.samples.length*this.bufferSize,t=new Float64Array(e),r=0;for(let a=0;a<this.samples.length;a++){let e=this.samples[a];t.set(e,r),r+=e.length}this.samples=t}_writeString(e,t,r){for(let a=0;a<r.length;a++)e.setUint8(t+a,r.charCodeAt(a))}}class Je{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.format=e.format,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this.wavSamples=[],this._duration=0}start(){this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia({video:!1,audio:{channelCount:1,echoCancellation:!1}}).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this._isMp3()&&!this.lameEncoder&&(this.lameEncoder=new Mp3Encoder(this.encoderOptions))}stop(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;if(this._isMp3())e=this.lameEncoder.finish();else{e=new Ge({bufferSize:this.bufferSize,sampleRate:this.encoderOptions.sampleRate,samples:this.wavSamples}).finish(),this.wavSamples=[]}e.duration=Pe(this.duration),this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}recordList(){return this.records}lastRecord(){return this.records.slice(-1).pop()}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let r=0;this._isMp3()?this.lameEncoder.encode(t):this.wavSamples.push(new Float32Array(t));for(let a=0;a<t.length;++a)r+=t[a]*t[a];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(r/t.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}_isMp3(){return"mp3"===this.format.toLowerCase()}}var et={props:{filename:{type:String,default:"record"},format:{type:String,default:"wav"},headers:{type:Object,default:()=>({})},uploadUrl:{type:String}}};const tt={mixins:[et],props:{record:{type:Object}},components:{IconButton:Fe},setup:(e,{emit:t})=>({upload:async()=>{if(I.state.checkedAudio){if(I.state.isCommentModal)I.commit("SET_ISCOMMENTMODAL",!1),t("insert-comment");else{const e={fileUrl:I.state.checkedAudio.name,tags:I.state.tags};let r=await function(e){return F.post("babble",e)}(e);r.data.user.avatar=`http://localhost:88/image/${r.data.user.avatar}`,I.commit("SET_CHECKEDAUDIO",null),t("insert-babble",r.data)}t("close-modal")}}})},rt=o("path",{d:"M0 0h24v24H0z",fill:"none"},null,-1),at=o("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"},null,-1);tt.render=function(e,t,r,a,o,i){return s(),l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"ar-icon ar-icon__xs ar-icon--no-border",onClick:t[1]||(t[1]=(...e)=>a.upload&&a.upload(...e))},[rt,at])};const st={headers:{"Content-Type":"multipart/form-data"}};const lt={mixins:[et],props:{time:{type:Number},bitRate:{type:Number,default:128},sampleRate:{type:Number,default:48e3},showUploadButton:{type:Boolean,default:!0},micFailed:{type:Function},beforeRecording:{type:Function},pauseRecording:{type:Function},afterRecording:{type:Function},failedUpload:{type:Function},beforeUpload:{type:Function},successfulUpload:{type:Function},selectRecord:{type:Function}},data(){return{isUploading:!1,recorder:this._initRecorder(),record:null,selected:{},uploadStatus:null,tags:[]}},components:{AudioPlayer:Ne,IconButton:Fe,Uploader:tt},beforeUnmount(){this.stopRecorder()},methods:{reset(){Object.assign(this.$data,this.$options.data.call(this))},toggleRecorder(){this.recorder.records.length>=this.attempts||(!this.isRecording||this.isRecording&&this.isPause?this.recorder.start():this.recorder.pause())},async stopRecorder(){if(!this.isRecording)return;this.recorder.stop();let e=this.recorder.recordList(),t=new File([e[0].blob],I.state.user.username,{type:e[0].blob.type,lastModified:e[0].blob.lastModified});const r=new FormData;r.append("audio",t);let a=await(s=r,z.post("STT",s,st));var s;let l=[];l=l.concat(a.data.emotion,a.data.keyword,a.data.sensitivity);let o=[];l.forEach((e=>{let t="";switch(e){case"기쁨":t="😍";break;case"신뢰":t="😉";break;case"공포":t="😱";break;case"놀라움":t="😲";break;case"슬품":t="😢";break;case"혐오":t="🤢";break;case"분노":t="😡";break;case"기대":t="😮";break;default:t="none"}"none"!==t&&o.push(t)})),l=l.concat(o),this.tags=l,this.record=`http://localhost:88/audio/${a.data.name}`,I.commit("SET_CHECKEDAUDIO",a.data),I.commit("SET_TAGS",l)},_initRecorder(){return new Je({beforeRecording:this.beforeRecording,afterRecording:this.afterRecording,pauseRecording:this.pauseRecording,micFailed:this.micFailed,bitRate:this.bitRate,sampleRate:this.sampleRate,format:this.format})},closeModal:function(){this.$emit("close-modal")},insertNewBabble:function(e){this.reset(),this.$emit("insert-babble",e)},insertNewComment:function(e){this.reset(),this.$emit("insert-comment")}},computed:{attemptsLeft(){return this.attempts-this.record.length},iconButtonType(){return this.isRecording&&this.isPause?"mic":this.isRecording?"pause":"mic"},isPause(){return this.recorder.isPause},isRecording(){return this.recorder.isRecording},recordedTime(){return this.recorder.duration>=30&&this.stopRecorder(),Pe(this.recorder.duration)},volume(){return parseFloat(this.recorder.volume)}}},ot={class:"ar"},it={key:0,class:"ar__overlay"},nt={key:1,class:"ar-spinner"},dt=o("div",{class:"ar-spinner__dot"},null,-1),ct=o("div",{class:"ar-spinner__dot"},null,-1),ut=o("div",{class:"ar-spinner__dot"},null,-1),bt={class:"ar-recorder"},pt={class:"audio_recorded"},ht={key:0,class:"ar-recorder__duration"},mt={key:1},ft={class:"parent"},gt=f("     "),vt=o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24",stroke:"#ff6b64","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[o("path",{d:"M14 2H6a2 2 0 0 0-2 2v16c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V8l-6-6z"}),o("path",{d:"M14 3v5h5M9.9 17.1L14 13M9.9 12.9L14 17"})],-1);lt.render=function(e,t,r,a,i,n){const d=b("icon-button"),c=b("audio-player"),u=b("uploader");return s(),l("div",ot,[i.isUploading?(s(),l("div",it)):w("",!0),i.isUploading?(s(),l("div",nt,[dt,ct,ut])):w("",!0),o("div",{class:["ar-content",{ar__blur:i.isUploading}]},[o("div",bt,[i.record?w("",!0):(s(),l(d,{key:0,class:["ar-icon ar-icon__lg",{"ar-icon--rec":n.isRecording,"ar-icon--pulse":n.isRecording&&n.volume>.02}],name:n.iconButtonType,onClick:n.toggleRecorder},null,8,["name","class","onClick"])),i.record?w("",!0):(s(),l(d,{key:1,class:"ar-icon ar-icon__sm ar-recorder__stop",name:"stop",onClick:n.stopRecorder},null,8,["onClick"]))]),o("div",pt,[i.record?(s(),l(c,{key:0,src:i.record},null,8,["src"])):w("",!0)]),i.record?w("",!0):(s(),l("div",ht,g(n.recordedTime),1)),i.tags?(s(),l("div",mt,[(s(!0),l(p,null,h(i.tags,(e=>(s(),l("span",{key:e}," #"+g(e)+"   ",1)))),128))])):w("",!0),o("div",ft,[i.record?(s(),l(u,{key:0,class:"ar__uploader",record:i.record,filename:e.filename,headers:e.headers,"upload-url":e.uploadUrl,onCloseModal:n.closeModal,onInsertBabble:n.insertNewBabble,onInsertComment:n.insertNewComment},null,8,["record","filename","headers","upload-url","onCloseModal","onInsertBabble","onInsertComment"])):w("",!0),gt,i.record?(s(),l("div",{key:1,class:"child",onClick:t[1]||(t[1]=(...e)=>n.reset&&n.reset(...e))},[vt])):w("",!0)])],2)])};var yt="data:image/png;base64,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";const xt={props:["babble"],components:{AudioRecorder:lt},setup(e,{emit:t}){const r=v(""),a=u((()=>I.state.user));e.babble&&I.commit("SET_ISCOMMENTMODAL",!0);return{onCommentBabble:async()=>{const r={babble:{id:e.babble.id},fileUrl:I.state.checkedAudio.name};let a=await function(e,t){return F.post(`babble/${e}/comment`,t)}(e.babble.id,r);I.commit("SET_ISCOMMENTMODAL",!1),I.commit("SET_CHECKEDAUDIO",null),t("close-modal",a.data),N(e.babble,this.currentUser)},currentUser:a,babbleBody:r,moment:k}}},wt={class:"flex justify-center min-h-screen sm:pt-6 sm:px-4 sm:pb-20 text-center sm:block sm:p-0"},kt=o("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[o("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1),Ct={class:"border-b border-gray-100 p-2 flex items-center justify-between"},Ut={class:"text-right sm:hidden mr-2"},Mt={key:0,class:"bg-light text-sm font-bold text-white px-4 py-1 rounded-full"},At={class:"flex px-4 pt-4 pb-3"},Rt={class:"flex flex-col"},Et={key:1,src:yt,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},Lt=o("div",{class:"ml-5 w-0.5 h-full bg-gray-300 mt-2 -mb-1"},null,-1),It={class:"ml-2 flex-1"},Tt={class:"flex space-x-2"},Bt={class:"font-bold text-sm"},Dt={class:"text-gray text-sm"},St={class:"text-gray text-sm"},zt={class:"text-primary text-sm"},Ft=o("span",{class:"text-gray text-sm"}," 님에게 보내는 답글",-1),Vt={class:"flex px-4 pb-4"},Pt={key:1,src:yt,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"};xt.render=function(e,t,r,a,i,n){const d=b("audio-recorder");return s(),l("div",{class:"fixed z-10 inset-0 overflow-y-auto",onClick:t[4]||(t[4]=t=>e.$emit("close-modal"))},[o("div",wt,[kt,o("div",{onClick:t[3]||(t[3]=y((()=>{}),["stop"])),class:"inline-block bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg w-full",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},[o("div",Ct,[o("button",{onClick:t[1]||(t[1]=t=>e.$emit("close-modal")),class:"fas fa-times text-primary text-lg p-2 h-10 w-10 hover:bg-blue-50 rounded-full"}),o("div",Ut,[a.babbleBody.length?(s(),l("button",{key:1,onClick:t[2]||(t[2]=(...e)=>a.onCommentBabble&&a.onCommentBabble(...e)),class:"bg-primary hover:bg-dark text-sm font-bold text-white px-4 py-1 rounded-full"}," 답글 ")):(s(),l("button",Mt," 답글 "))])]),o("div",null,[o("div",At,[o("div",Rt,["null"!==r.babble.user.avatar.slice(-4)?(s(),l("img",{key:0,src:r.babble.user.avatar,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},null,8,["src"])):(s(),l("img",Et)),Lt]),o("div",It,[o("div",Tt,[o("span",Bt,g(r.babble.user.username),1),o("span",Dt,"@"+g(r.babble.user.nickname),1),o("span",St,g(a.moment(r.babble.regDate).fromNow()),1)]),o("div",null,[o("span",zt,"@"+g(r.babble.user.nickname),1),Ft])])]),o("div",Vt,["null"!==a.currentUser.avatar.slice(-4)?(s(),l("img",{key:0,src:a.currentUser.avatar,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},null,8,["src"])):(s(),l("img",Pt)),o(d,{onInsertComment:a.onCommentBabble},null,8,["onInsertComment"])])])])])])};const _t={components:{CommentModal:xt,AudioPlayer:Te},props:["currentUser","babble"],methods:{onDeleteBabble(e){confirm("정말로 배블을 삭제하시겠습니까?")&&(Be(e),this.isRebabbled=!1,this.$emit("delete",this.babble))},async onInsertRebabble(e){const t={fileUrl:e.fileUrl,tags:e.tags,rebabbleId:e.id};let r=await De(t);r.data.user.avatar=`http://localhost:88/image/${r.data.user.avatar}`,this.$emit("rebabble",r.data),this.babble.rebabbles.push(r.data),this.isRebabbled=!0,O(this.babble,this.currentUser)},onDeleteRebabble(){this.babble.rebabbles.forEach((e=>{if(e.user.id===this.currentUser.id){Be(e.id);let t=this.babble.rebabbles.indexOf(e);this.babble.rebabbles.splice(t,1),this.$emit("unrebabble",e.id)}})),this.isRebabbled=!1},handleLike(e){Se(e.id),this.babble.likes.push(this.currentUser),this.isLiked=!0,this.$emit("like",e),H(this.babble,this.currentUser)},handleUnlike(e){ze(e),this.babble.likes=this.babble.likes.filter((e=>e.id!=this.currentUser.id)),this.isLiked=!1,this.$emit("unlike",e)},onCloseModal(e){this.babble.comments.push(e),showCommentModal=!1}},setup(e){const t=v(!1),r=v(!1),a=v(!1);return e.babble.rebabbles.forEach((t=>{t.user.id===e.currentUser.id&&(r.value=!0)})),e.babble.likes.forEach((t=>{t.id===e.currentUser.id&&(a.value=!0)})),{showCommentModal:t,isRebabbled:r,isLiked:a,moment:k}}},$t={class:"flex px-3 py-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer"},jt={key:1,src:yt,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},Nt={class:"ml-3 flex-1 flex flex-col space-y-1"},Ot={key:0},Ht={class:"text-sm flex justify-between items-center"},Kt={class:"space-x-1"},Qt={class:"font-bold"},Zt={class:"text-gray-500 text-xs"},Wt=o("span",null,"·",-1),qt={class:"text-gray-500 text-xs"},Xt=o("i",{class:"fas fa-trash text-red-400 p-2 rounded-full hover:bg-red-50"},null,-1),Yt={class:"flex justify-between"},Gt=o("i",{class:"far fa-comment hover:bg-blue-50 rounded-full p-2"},null,-1),Jt={class:"ml-1 text-sm"},er=o("i",{class:"fas fa-retweet hover:bg-green-50 rounded-full p-2"},null,-1),tr={class:"ml-1 text-sm"},rr=o("i",{class:"fas fa-retweet hover:bg-green-50 rounded-full p-2"},null,-1),ar={class:"ml-1 text-sm"},sr=o("i",{class:"far fa-heart hover:bg-red-50 rounded-full p-2"},null,-1),lr={class:"ml-1 text-sm"},or=o("i",{class:"far fa-heart hover:bg-red-50 rounded-full p-2"},null,-1),ir={class:"ml-1 text-sm"},nr=o("div",{class:"text-gray-500 hover:text-primary"},null,-1);_t.render=function(e,t,r,a,i,n){const d=b("router-link"),c=b("audio-player"),u=b("comment-modal");return s(),l("div",$t,[o(d,{to:`/profile/${r.babble.user.id}`},{default:m((()=>["null"!==r.babble.user.avatar.slice(-4)?(s(),l("img",{key:0,src:r.babble.user.avatar,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},null,8,["src"])):(s(),l("img",jt))])),_:1},8,["to"]),o("div",Nt,[r.babble.rebabbleUser?(s(),l("div",Ot," Rebabbleed by "+g(r.babble.rebabbleUser.username),1)):w("",!0),o("div",Ht,[o(d,{to:`/babble/${r.babble.id}`},{default:m((()=>[o("div",Kt,[o("span",Qt,g(r.babble.user.username),1),o("span",Zt,"@"+g(r.babble.user.nickname),1),Wt,o("span",qt,g(a.moment(r.babble.regDate).fromNow()),1)])])),_:1},8,["to"]),r.currentUser.id===r.babble.user.id?(s(),l("button",{key:0,onClick:t[1]||(t[1]=e=>n.onDeleteBabble(r.babble.id))},[Xt])):w("",!0)]),o("div",null,[(s(!0),l(p,null,h(r.babble.tags,(e=>(s(),l("span",{key:e},[o(d,{to:`/${e}`},{default:m((()=>[f(" #"+g(e)+"  ",1)])),_:2},1032,["to"])])))),128))]),o(c,{audioUrl:r.babble.fileUrl},null,8,["audioUrl"]),o("div",Yt,[o("div",{onClick:t[2]||(t[2]=e=>a.showCommentModal=!0),class:"text-gray-500 hover:text-primary"},[Gt,o("span",Jt,g(r.babble.comments.length),1)]),a.isRebabbled?(s(),l("div",{key:1,class:"text-green-400",onClick:t[4]||(t[4]=e=>n.onDeleteRebabble())},[rr,o("span",ar,g(r.babble.rebabbles.length),1)])):(s(),l("div",{key:0,class:"text-gray-500 hover:text-green-400",onClick:t[3]||(t[3]=e=>n.onInsertRebabble(r.babble))},[er,o("span",tr,g(r.babble.rebabbles.length),1)])),a.isLiked?(s(),l("div",{key:3,class:"text-red-400",onClick:t[6]||(t[6]=e=>n.handleUnlike(r.babble.id))},[or,o("span",ir,g(r.babble.likes.length),1)])):(s(),l("div",{key:2,class:"text-gray-400 hover:text-red-400",onClick:t[5]||(t[5]=e=>n.handleLike(r.babble))},[sr,o("span",lr,g(r.babble.likes.length),1)])),nr])]),a.showCommentModal?(s(),l(u,{key:0,babble:r.babble,onCloseModal:n.onCloseModal},null,8,["babble","onCloseModal"])):w("",!0)])};const dr={components:{Trends:K,Babble:_t,ProfileEditModal:ue,AudioPlayer:Te},methods:{deleteBabble(e){this.babbles=this.babbles.filter((t=>t!==e))},deleteRebabble(e){this.rebabbles=this.rebabbles.filter((t=>t.id!==e))},addRebabble(e){this.profileUser.id===this.currentUser.id&&this.rebabbles.push(e)},editProfileUser(){this.showProfileEditModal=!1,window.location.reload()},addLike(e){this.profileUser.id===this.currentUser.id&&this.profileUser.likeBabbles.push(e)},deleteLike(e){this.profileUser.likeBabbles=this.profileUser.likeBabbles.filter((t=>t.id!==e))}},computed:{isFollowed(){let e=!1;return this.profileUser.followers.forEach((t=>{t.id===this.currentUser.id&&(e=!0)})),e}},watch:{"$route.params.id"(){window.location.reload()}},setup(){const e=u((()=>I.state.user)),t=v(!1),r=v("babble"),a=v(null),s=v([]),l=U(),o=v([]);C((async()=>{var t;const r=null!=(t=l.params.id)?t:e.value.id;let i=await function(e){return F.get(`user/${e}`)}(r);i.data.avatar=`http://localhost:88/image/${i.data.avatar}`,i.data.background=`http://localhost:88/image/${i.data.background}`,a.value=i.data,i.data.babbles.forEach((e=>{e.user.avatar=`http://localhost:88/image/${e.user.avatar}`,null!==e.rebabbleId?s.value.push(e):o.value.push(e)})),a.value.likeBabbles.forEach((e=>{e.user.avatar=`http://localhost:88/image/${e.user.avatar}`})),a.value.id===e.value.id&&I.commit("SET_USER",i.data)}));return{showProfileEditModal:t,currentUser:e,profileUser:a,currentTab:r,onUnFollow:()=>{var t;t=a.value.id,F.delete(`user/${t}/follow`),a.value.followers=a.value.followers.filter((t=>t.id!==e.value.id))},rebabbles:s,onFollow:()=>{var t;t=a.value.id,F.post(`user/${t}/follow`),a.value.followers.push(e.value),function(e,t){e.id!==t.id&&$({sender:t.id,sender_avatar:t.avatar,receiver:e.id,message:`${t.username}님이 회원님을 팔로우합니다.`,timestamp:Date.now()})}(a.value,e.value)},babbles:o,moment:k,router:Ka}}},cr={key:0,class:"flex-1 flex"},ur={class:"flex-1 flex flex-col border-r border-color"},br={class:"px-3 py-1 flex border-b border-color"},pr=o("i",{class:"fas fa-arrow-left text-primary p-3 rounded-full hover:bg-blue-50"},null,-1),hr={class:"font-extrabold text-lg"},mr={class:"text-xs text-gray"},fr={class:"bg-gray-300 h-48 relative flex-none"},gr={key:1,src:"/assets/defaultBackground.a887cb14.jpg",class:"w-full h-48 object-cover"},vr={class:"border-4 border-white bg-gray-100 w-28 h-28 rounded-full absolute -bottom-14 left-2"},yr={key:1,src:yt,class:"w-full h-full rounded-full opacity-90 hover:opacity-100 cursor-pointer"},xr={class:"text-right mt-2 mr-2 mb-10 relative"},wr={key:0},kr={key:1},Cr=o("button",{class:"absolute w-24 right-0 text-sm bg-primary text-white px-3 py-2 hover:opacity-0 font-bold rounded-full"}," 팔로잉 ",-1),Ur=o("button",{class:"absolute w-24 right-0 text-sm bg-red-400 text-white px-3 py-2 opacity-0 hover:opacity-100 font-bold rounded-full"}," 언팔로우 ",-1),Mr=o("button",{class:"absolute right-0 w-24 border text-sm border-primary text-primary px-3 py-2 hover:bg-blue-50 font-bold rounded-full"}," 팔로우 ",-1),Ar={class:"mx-3 mt-2"},Rr={class:"font-extrabold text-lg"},Er={class:"text-gray"},Lr=o("span",{class:"text-gray"},"가입일: ",-1),Ir={class:"text-gray"},Tr={class:"font-bold mr-1"},Br=o("span",{class:"text-gray mr-3"},"팔로우 중",-1),Dr={class:"font-bold mr-1"},Sr=o("span",{class:"text-gray"},"팔로워",-1),zr={class:"flex border-b border-color mt-3"},Fr={class:"overflow-y-auto"};dr.render=function(e,t,r,a,i,n){const d=b("Babble"),c=b("Trends"),u=b("profile-edit-modal");return a.profileUser?(s(),l("div",cr,[o("div",ur,[o("div",br,[o("button",{class:"mr-4",onClick:t[1]||(t[1]=e=>a.router.go(-1))},[pr]),o("div",null,[o("div",hr,g(a.profileUser.username),1),o("div",mr,g(a.babbles.length)+" 배블",1)])]),o("div",fr,["null"!==e.$store.state.user.avatar.slice(-4)?(s(),l("img",{key:0,src:a.profileUser.background,class:"w-full h-48 object-cover"},null,8,["src"])):(s(),l("img",gr)),o("div",vr,["null"!==a.profileUser.avatar.slice(-4)?(s(),l("img",{key:0,src:a.profileUser.avatar,class:"w-full h-full rounded-full opacity-90 hover:opacity-100 cursor-pointer"},null,8,["src"])):(s(),l("img",yr))])]),o("div",xr,[a.currentUser.id===a.profileUser.id?(s(),l("div",wr,[o("button",{onClick:t[2]||(t[2]=e=>a.showProfileEditModal=!0),class:"border text-sm border-primary text-primary px-3 py-2 hover:bg-blue-50 font-bold rounded-full"}," 프로필 수정 ")])):(s(),l("div",kr,[n.isFollowed?(s(),l("div",{key:0,class:"",onClick:t[3]||(t[3]=(...e)=>a.onUnFollow&&a.onUnFollow(...e))},[Cr,Ur])):(s(),l("div",{key:1,onClick:t[4]||(t[4]=(...e)=>a.onFollow&&a.onFollow(...e))},[Mr]))]))]),o("div",Ar,[o("div",Rr,g(a.profileUser.lastName+a.profileUser.firstName),1),o("div",Er,"@"+g(a.profileUser.nickname),1),o("div",null,g(a.profileUser.bio),1),o("div",null,[Lr,o("span",Ir,g(a.moment(a.profileUser.regDate).format("YYYY년 MM월")),1)]),o("div",null,[o("span",Tr,g(a.profileUser.followings.length),1),Br,o("span",Dr,g(a.profileUser.followers.length),1),Sr])]),o("div",zr,[o("div",{onClick:t[5]||(t[5]=e=>a.currentTab="babble"),class:("babble"==a.currentTab?"border-b border-primary text-primary":" text-gray")+" py-3  font-bold  text-center w-1/3 hover:bg-blue-50 cursor-pointer hover:text-primary"}," 배블 ",2),o("div",{onClick:t[6]||(t[6]=e=>a.currentTab="rebabble"),class:("rebabble"==a.currentTab?"border-b border-primary text-primary":" text-gray")+" py-3  font-bold  text-center w-1/3 hover:bg-blue-50 cursor-pointer hover:text-primary"}," 리배블 ",2),o("div",{onClick:t[7]||(t[7]=e=>a.currentTab="like"),class:("like"==a.currentTab?"border-b border-primary text-primary":" text-gray")+" py-3  font-bold  text-center w-1/3 hover:bg-blue-50 cursor-pointer hover:text-primary"}," 좋아요 ",2)]),o("div",Fr,[(s(!0),l(p,null,h("babble"==a.currentTab?a.babbles:"rebabble"==a.currentTab?a.rebabbles:a.profileUser.likeBabbles,(e=>(s(),l(d,{key:e.id,currentUser:a.currentUser,babble:e,onDelete:n.deleteBabble,onUnrebabble:n.deleteRebabble,onRebabble:n.addRebabble,onLike:n.addLike,onUnlike:n.deleteLike},null,8,["currentUser","babble","onDelete","onUnrebabble","onRebabble","onLike","onUnlike"])))),128))])]),o(c),a.showProfileEditModal?(s(),l(u,{key:0,onCloseModal:n.editProfileUser},null,8,["onCloseModal"])):w("",!0)])):w("",!0)};const Vr={props:["audioUrl","playerid"],data:()=>({playbackTime:0,audioDuration:100,audioLoaded:!1,isPlaying:!1,url:""}),setup(e){const t=v(null);return C((async()=>{t.value=`http://localhost:88/audio/${e.audioUrl}`})),{url:t}},methods:{initSlider(){var e=this.$refs.player;e&&(this.audioDuration=Math.round(e.duration))},convertTime:e=>[e%3600/60,e%60].map((e=>`0${Math.floor(e)}`.slice(-2))).join(":"),totalTime(){var e=this.$refs.player;if(e){var t=e.duration;return this.convertTime(t)}return"00:00"},elapsedTime(){var e=this.$refs.player;if(e){var t=e.currentTime;return this.convertTime(t)}return"00:00"},playbackListener(e){var t=this.$refs.player;this.playbackTime=t.currentTime,t.addEventListener("ended",this.endListener),t.addEventListener("pause",this.pauseListener)},pauseListener(){this.isPlaying=!1,this.listenerActive=!1,this.cleanupListeners()},endListener(){this.isPlaying=!1,this.listenerActive=!1,this.cleanupListeners()},cleanupListeners(){var e=this.$refs.player;e.removeEventListener("freqtimeupdate",this.playbackListener),e.removeEventListener("ended",this.endListener),e.removeEventListener("pause",this.pauseListener)},toggleAudio(){var e=this.$refs.player;e.paused?(e.play(),this.isPlaying=!0):(e.pause(),this.isPlaying=!1)}},mounted:function(){this.$nextTick((function(){var e=this.$refs.player;e.addEventListener("loadedmetadata",function(e){this.initSlider()}.bind(this)),e.addEventListener("canplay",function(e){this.audioLoaded=!0}.bind(this)),this.$watch("isPlaying",(function(){if(this.isPlaying){var e=this.$refs.player;this.initSlider(),this.listenerActive||(this.listenerActive=!0,e.addEventListener("freqtimeupdate",this.playbackListener))}})),this.$watch("playbackTime",(function(){this.$refs.player,Math.abs(this.playbackTime-this.$refs.player.currentTime)>.01&&(this.$refs.player.currentTime=this.playbackTime)}))}))}},Pr={id:"audio-player-root"},_r={class:"w-3/4 max-w-5xl bg-gray-200 border border-gray-300 px-2 pt-2 mt-4 shadow-md",style:{margin:"0px"}},$r={id:"player-row",class:"inline-flex flex-wrap w-full"},jr={id:"button-div",class:"flex-initial pr-3"},Nr=o("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1),Or=o("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1),Hr={id:"progress-bar",class:"flex-grow bg-white border border-blue-200"},Kr={class:"overlay-container relative w-full h-full"},Qr={class:"w-full absolute top-0 bottom-0 right-0 left-0 px-2 pointer-events-none",style:{color:"#94bcec"}},Zr={class:"flex w-full justify-between absolute top-0 bottom-0 right-0 left-0 px-2 pointer-events-none"},Wr={class:"text-sm",style:{color:"#94bcec"}},qr={class:"text-sm",style:{color:"#94bcec"}};Vr.render=function(e,t,r,a,d,c){return s(),l("div",Pr,[o("div",null,[o("audio",{style:{display:"none"},ref:"player",id:r.playerid},[o("source",{src:a.url,type:"audio/mp3"},null,8,["src"])],8,["id"])]),o("div",_r,[o("div",$r,[o("div",jr,[i((s(),l("svg",{onClick:t[1]||(t[1]=e=>c.toggleAudio()),class:["play-button text-gray-400",{"text-orange-600":d.audioLoaded,"hover:text-orange-400":d.audioLoaded,"cursor-pointer":d.audioLoaded}],xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[Nr],2)),[[M,!d.isPlaying]]),i((s(),l("svg",{onClick:t[2]||(t[2]=e=>c.toggleAudio()),class:"play-button text-orange-400 hover:text-orange-400 cursor-pointer",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[Or],512)),[[M,d.isPlaying]])]),o("div",Hr,[o("div",Kr,[i(o("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>d.playbackTime=e),type:"range",min:"0",max:d.audioDuration,class:"slider w-full h-full",id:"position",name:"position"},null,8,["max"]),[[n,d.playbackTime]]),i(o("div",Qr," Loading please wait... ",512),[[M,!d.audioLoaded]]),i(o("div",Zr,[o("span",Wr,g(c.elapsedTime()),1),o("span",qr,g(c.totalTime()),1)],512),[[M,d.audioLoaded]])])])])])])};const Xr={components:{Trends:K,CommentModal:xt,AudioPlayer:Te,DetailAudioPlayer:Vr},methods:{onAddComment(e){e&&(e.user.avatar=`http://localhost:88/image/${e.user.avatar}`,this.babble.comments.push(e)),this.showCommentModal=!1,N(this.babble,this.currentUser)},onDeleteComment(e){confirm("정말로 답글을 삭제하시겠습니까?")&&(!function(e,t){F.delete(`babble/${e}/comment/${t}`)}(this.babble.id,e),this.babble.comments=this.babble.comments.filter((t=>t.id!==e)))},async onRebabble(){if(this.isRebabbled)this.babble.rebabbles.forEach((e=>{if(e.user.id===this.currentUser.id){Be(e.id);let t=this.babble.rebabbles.indexOf(e);this.babble.rebabbles.splice(t,1)}})),this.isRebabbled=!1;else{const e={fileUrl:this.babble.fileUrl,tags:this.babble.tags,rebabbleId:this.babble.id},t=await De(e);this.babble.rebabbles.push(t.data),this.isRebabbled=!0,O(this.babble,this.currentUser)}},async handleLikes(){this.isLiked?(ze(this.babble.id),this.babble.likes=this.babble.likes.filter((e=>e.id!==this.currentUser.id)),this.isLiked=!1):(Se(this.babble.id),this.babble.likes.push(this.currentUser),this.isLiked=!0,H(this.babble,this.currentUser))}},setup(){const e=u((()=>I.state.user)),t=v(!1),r=v(!1),a=v(!1),s=v(null),l=v([]),o=U();return C((async()=>{let t=await(l=o.params.id,F.get(`/babble/${l}`));var l;s.value=t.data,s.value.user.avatar=`http://localhost:88/image/${s.value.user.avatar}`,s.value.comments.forEach((e=>{e.user.avatar=`http://localhost:88/image/${e.user.avatar}`})),s.value.rebabbles.forEach((t=>{t.user.id===e.value.id&&(r.value=!0)})),s.value.likes.forEach((t=>{t.id===e.value.id&&(a.value=!0)}))})),{showCommentModal:t,currentUser:e,isRebabbled:r,comments:l,isLiked:a,router:Ka,babble:s,moment:k}}},Yr={class:"flex-1 flex"},Gr={class:"flex-1 border-r border-gray-100"},Jr={key:0,class:"flex flex-col"},ea={class:"flex items-center px-3 py-2 border-b border-gray-100"},ta=o("i",{class:"fas fa-arrow-left text-primary text-lg ml-3 hover:bg-blue-50 p-2 rounded-full h-10 w-10"},null,-1),ra=o("span",{class:"font-bold text-lg ml-6"},"트윗",-1),aa={class:"px-3 py-2 flex"},sa={key:1,src:yt,class:"w-10 h-10 rounded-full hover:opacity-90 cursor-pointer"},la={class:"ml-2"},oa={class:"font-bold"},ia={class:"text-gray text-sm"},na={class:"tag"},da={class:"px-3 py-2 text-gray text-xs"},ca=o("div",{class:"h-px w-full bg-gray-100"},null,-1),ua={class:"flex space-x-2 px-3 py-2 items-center"},ba={class:""},pa=o("span",{class:"text-sm text-gray"},"리배블",-1),ha={class:"ml-5"},ma=o("span",{class:"text-sm text-gray"},"마음에 들어요",-1),fa=o("div",{class:"h-px w-full bg-gray-100"},null,-1),ga={class:"flex justify-around py-2"},va=o("i",{class:"far fa-comment text-gray-400 text-xl hover:bg-blue-50 hover:text-primary p-2 rounded-full h-10 w-10"},null,-1),ya={key:0,class:"fas fa-retweet text-xl hover:bg-green-50 text-green-400 p-2 rounded-full h-10 w-10"},xa={key:1,class:"fas fa-retweet text-gray-400 text-xl hover:bg-green-50 hover:text-green-400 p-2 rounded-full h-10 w-10"},wa={key:0,class:"far fa-heart text-xl hover:bg-red-50 text-red-400 p-2 rounded-full h-10 w-10"},ka={key:1,class:"far fa-heart text-gray-400 text-xl hover:bg-red-50 hover:text-red-400 p-2 rounded-full h-10 w-10"},Ca=o("div",{class:"h-px w-full bg-gray-100"},null,-1),Ua={key:1,src:yt,class:"w-10 h-10 rounded-full hover:opacity-90 cursor-pointer"},Ma={class:"ml-2 flex-1"},Aa={class:"flex items-center space-x-2"},Ra={class:"font-bold"},Ea={class:"text-gray text-sm"},La=o("i",{class:"fas fa-trash text-red-400 hover:bg-red-50 w-10 h-10 rounded-full p-2"},null,-1);Xr.render=function(e,t,r,a,i,n){const d=b("router-link"),c=b("detail-audio-player"),u=b("audio-player"),v=b("trends"),y=b("comment-modal");return s(),l("div",Yr,[o("div",Gr,[a.babble?(s(),l("div",Jr,[o("div",ea,[o("button",{onClick:t[1]||(t[1]=e=>a.router.go(-1))},[ta]),ra]),o("div",aa,["null"!==a.babble.user.avatar.slice(-4)?(s(),l("img",{key:0,src:a.babble.user.avatar,class:"w-10 h-10 rounded-full hover:opacity-90 cursor-pointer"},null,8,["src"])):(s(),l("img",sa)),o("div",la,[o("div",oa,g(a.babble.user.username),1),o("div",ia,"@"+g(a.babble.user.nickname),1)])]),o("div",na,[(s(!0),l(p,null,h(a.babble.tags,(e=>(s(),l("span",{key:e},[o(d,{to:`/${e}`},{default:m((()=>[f(" #"+g(e)+"  ",1)])),_:2},1032,["to"])])))),128))]),o(c,{class:"px-3 py-2",audioUrl:a.babble.fileUrl,playerid:"audio-player"},null,8,["audioUrl"]),o("div",da,g(a.moment(a.babble.regDate).fromNow()),1),ca,o("div",ua,[o("span",ba,g(a.babble.rebabbles.length),1),pa,o("span",ha,g(a.babble.likes.length),1),ma]),fa,o("div",ga,[o("button",{onClick:t[2]||(t[2]=e=>a.showCommentModal=!0)},[va]),o("button",{onClick:t[3]||(t[3]=e=>n.onRebabble())},[a.isRebabbled?(s(),l("i",ya)):(s(),l("i",xa))]),o("button",{onClick:t[4]||(t[4]=e=>n.handleLikes())},[this.isLiked?(s(),l("i",wa)):(s(),l("i",ka))])]),Ca,(s(!0),l(p,null,h(a.babble.comments,(e=>(s(),l("div",{key:e,class:"flex hover:bg-gray-50 cursor-pointer px-3 py-3 border-b border-gray-100"},["null"!==e.user.avatar.slice(-4)?(s(),l("img",{key:0,src:e.user.avatar,class:"w-10 h-10 rounded-full hover:opacity-90 cursor-pointer"},null,8,["src"])):(s(),l("img",Ua)),o("div",Ma,[o("div",Aa,[o("span",Ra,g(e.user.username),1),o("span",Ea,"@"+g(e.user.nickname),1),o("span",null,g(a.moment(e.regDate).fromNow()),1)]),o(u,{class:"px-3 py-2",audioUrl:e.fileUrl},null,8,["audioUrl"])]),e.user.id===a.currentUser.id?(s(),l("button",{key:2,onClick:t=>n.onDeleteComment(e.id)},[La],8,["onClick"])):w("",!0)])))),128))])):w("",!0)]),o(v),a.showCommentModal?(s(),l(y,{key:0,babble:a.babble,onCloseModal:n.onAddComment},null,8,["babble","onCloseModal"])):w("",!0)])};const Ia={components:{AudioRecorder:lt},setup(){const e=v(""),t=v(""),r=v(!1),s=a();return{email:e,password:t,loading:r,onLogin:async()=>{if(!e.value||!t.value)return void alert("이메일, 비밀번호를 모두 입력해주세요.");r.value=!0;const a={username:e.value,password:t.value};I.commit("SET_USERNAME",e.value),I.commit("SET_PASSWORD",t.value);const l=await T(a);await I.commit("SET_TOKEN",l.headers.authorization);const o=await F.get("my");o.data.avatar=`http://localhost:88/image/${o.data.avatar}`,o.data.background=`http://localhost:88/image/${o.data.background}`,I.commit("SET_USER",o.data),r.value=!1,s.replace("/")}}}},Ta={class:"flex flex-col items-center space-y-4 mt-10"},Ba=f("   "),Da=o("br",null,null,-1),Sa=o("img",{src:"/assets/6.3545caac.jpg",width:"300",height:"300",class:"text-4xl text-primary"},null,-1),za={key:0,class:"w-96 rounded bg-light text-white py-3"},Fa=o("button",{class:"text-primary"},"계정이 없으신가요? 회원가입 하기",-1);Ia.render=function(e,t,r,a,c,u){const p=b("router-link");return s(),l("div",Ta,[Ba,Da,Sa,i(o("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.email=e),type:"text",class:"rounded w-96 px-4 py-3 border border-gray-300 focus:ring-2 focus:border-primary focus:outline-none",placeholder:"이메일"},null,512),[[n,a.email]]),i(o("input",{onKeyup:t[2]||(t[2]=d(((...e)=>a.onLogin&&a.onLogin(...e)),["enter"])),"onUpdate:modelValue":t[3]||(t[3]=e=>a.password=e),type:"password",class:"rounded w-96 px-4 py-3 border border-gray-300 focus:ring-2 focus:border-primary focus:outline-none",placeholder:"비밀번호"},null,544),[[n,a.password]]),a.loading?(s(),l("button",za," 로그인 중입니다. ")):(s(),l("button",{key:1,class:"w-96 rounded bg-primary text-white py-3 hover:bg-dark",onClick:t[4]||(t[4]=(...e)=>a.onLogin&&a.onLogin(...e))}," 로그인 ")),o(p,{to:"/register"},{default:m((()=>[Fa])),_:1})])};const Va={components:{Trends:K,Babble:_t,AudioRecorder:lt},watch:{async"$route.params.tag"(e){let t=await(r=e,F.get(`babbles/${r}`));var r;this.babbles=t.data,this.babbles.forEach((e=>{e.user.avatar=`http://localhost:88/image/${e.user.avatar}`}))}},methods:{onDeleteBabble(e){this.babbles=this.babbles.filter((t=>t!==e))},onDeleteRebabble(e){this.babbles=this.babbles.filter((t=>t.id!==e))},oninsertRebabble(e){this.babbles.push(e)},insertNewBabble:function(e){this.babbles.push(e)}},setup(){const e=u((()=>I.state.user)),t=v([]);return C((async()=>{const e=await F.get("babbles");t.value=e.data,t.value.forEach((e=>{e.user.avatar=`http://localhost:88/image/${e.user.avatar}`}))})),{currentUser:e,babbles:t}}},Pa={class:"flex-1 border-r border-gray-100 overflow-y-auto"},_a={class:"flex flex-col"},$a=o("div",{class:"border-b border-gray-100 px-3 py-2 font-bold text-lg"},"홈",-1),ja={class:"flex px-3 py-3 border-b-8 border-gray-100"},Na={key:1,src:yt,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},Oa={class:"ml-2 flex-1 flex flex-col"};Va.render=function(e,t,r,a,i,n){const d=b("audio-recorder"),c=b("Babble"),u=b("Trends");return s(),l(p,null,[o("div",Pa,[o("div",_a,[$a,o("div",ja,["null"!==e.$store.state.user.avatar.slice(-4)?(s(),l("img",{key:0,src:e.$store.state.user.avatar,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},null,8,["src"])):(s(),l("img",Na)),o("div",Oa,[o(d,{onInsertBabble:n.insertNewBabble},null,8,["onInsertBabble"])])]),(s(!0),l(p,null,h(a.babbles,(e=>(s(),l(c,{currentUser:a.currentUser,babble:e,key:e.id,onDelete:n.onDeleteBabble,onUnrebabble:n.onDeleteRebabble,onRebabble:n.oninsertRebabble},null,8,["currentUser","babble","onDelete","onUnrebabble","onRebabble"])))),128))])]),o(u)],64)};const Ha=[{path:"/",name:"home",component:Va,title:"홈",icon:"fas fa-home fa-fw text-2xl",meta:{isMenu:!0,layout:"DefaultLayout",requireAuth:!0}},{path:"/notifications",name:"notifications",component:X,title:"알림",icon:"far fa-bell fa-fw text-2xl",meta:{isMenu:!0,layout:"DefaultLayout",requireAuth:!0}},{path:"/profile",name:"profile",component:dr,title:"프로필",icon:"far fa-user fa-fw text-2xl",meta:{isMenu:!0,layout:"DefaultLayout",requireAuth:!0}},{path:"/profile/:id",component:dr,meta:{isMenu:!1,layout:"DefaultLayout",requireAuth:!0}},{path:"/babble/:id",name:"babble",component:Xr,meta:{isMenu:!1,layout:"DefaultLayout",requireAuth:!0}},{path:"/:tag",component:Va,meta:{isMenu:!1,layout:"DefaultLayout",requireAuth:!0}},{path:"/register",name:"register",component:te,meta:{isMenu:!1,layout:"EmptyLayout"}},{path:"/login",name:"login",component:Ia,meta:{isMenu:!1,layout:"EmptyLayout"}}],Ka=A({history:R(),routes:Ha});Ka.beforeEach(((e,t,r)=>{const a=I.state.user;e.matched.some((e=>e.meta.requireAuth))&&!a?r("/login"):(I.state.user&&I.commit("SET_NOTIFICATIONINTERVAL",async function(e){clearInterval(I.state.notificationInterval);const t=await j(e);return console.log(t.data.hits.hits),I.state.notifications=t.data.hits.hits,setInterval((async()=>{const t=await j(e);console.log(t.data.hits.hits),I.state.notifications=t.data.hits.hits}),1e4)}(I.state.user.id)),r())}));const Qa={components:{AudioRecorder:lt},setup:({emit:e})=>({currentUser:u((()=>I.state.user)),closeModal:()=>{e("close-modal")}})},Za={class:"flex justify-center min-h-screen sm:pt-6 sm:px-4 sm:pb-20 text-center sm:block sm:p-0"},Wa=o("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[o("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1),qa={class:"border-b border-gray-100 p-2 flex items-center justify-between"},Xa={class:"flex p-4"},Ya={key:1,src:yt,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},Ga={class:"ml-2 flex-1 flex flex-col"};Qa.render=function(e,t,r,a,i,n){const d=b("audio-recorder");return s(),l("div",{class:"fixed z-10 inset-0 overflow-y-auto",onClick:t[3]||(t[3]=t=>e.$emit("close-modal"))},[o("div",Za,[Wa,o("div",{onClick:t[2]||(t[2]=y((()=>{}),["stop"])),class:"inline-block bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg w-full",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},[o("div",qa,[o("button",{onClick:t[1]||(t[1]=t=>e.$emit("close-modal")),class:"fas fa-times text-primary text-lg p-2 h-10 w-10 hover:bg-blue-50 rounded-full"})]),o("div",Xa,["null"!==a.currentUser.avatar.slice(-4)?(s(),l("img",{key:0,src:a.currentUser.avatar,class:"w-10 h-10 rounded-full hover:opacity-80 cursor-pointer"},null,8,["src"])):(s(),l("img",Ya)),o("div",Ga,[o(d,{onCloseModal:a.closeModal},null,8,["onCloseModal"])])])])])])};const Ja={components:{BabbleModal:Qa},setup(){const e=v([]),t=v(!1),r=v(!1),a=u((()=>I.state.user));return C((()=>{e.value=Ka.options.routes.filter((e=>1==e.meta.isMenu))})),{showProfileDropdown:t,showBabbleModal:r,currentUser:a,onLogout:async()=>{I.commit("CLEAR_DATA"),await Ka.replace("/login")},routes:e,router:Ka}}},es={key:0,class:"flex h-screen container mx-auto relative"},ts={class:"w-20 xl:w-1/4 pt-5 xl:ml-10 flex flex-col justify-between border-r border-gray-100"},rs={class:"flex flex-col items-center xl:items-start"},as=o("img",{src:"/assets/5.793fe2a5.jpg",width:"200",height:"200",class:"text-3xl text-primary xl:ml-4 mb-3"},null,-1),ss={class:"flex flex-col items-start space-y-1"},ls={key:0},os={class:"ml-5 text-xl hidden xl:inline-block"},is={class:"w-full xl:pr-3 flex justify-center"},ns=o("span",{class:"hidden xl:block"},"Babble",-1),ds=o("i",{class:"fas fa-plus xl:hidden"},null,-1),cs={class:"hidden xl:flex mt-3 px-2 py-1 w-full h-12 rounded-full hover:bg-blue-50 items-center"},us={key:1,src:yt,class:"w-10 h-10 rounded-full"},bs={class:"xl:ml-2 hidden xl:block"},ps={class:"text-sm font-bold"},hs={class:"text-xs text-gray-500 text-left"},ms=o("i",{class:"ml-auto fas fa-ellipsis-h fa-fw text-xs hidden xl:block"},null,-1),fs={class:"xl:hidden flex justify-center"},gs={key:1,src:yt,class:"w-10 h-10 rounded-full cursor-pointer hover:opacity-80"},vs={class:"flex-1 flex h-screen"},ys={class:"hover:bg-gray-50 border-b border-gray-100 flex p-3 w-full items-center"},xs={key:1,src:yt,class:"w-10 h-10 rounded-full"},ws={class:"ml-2"},ks={class:"font-bold text-sm"},Cs={class:"text-left text-gray-500 text-sm"},Us=o("i",{class:"fas fa-check text-primary ml-auto"},null,-1);Ja.render=function(e,t,r,a,i,n){const d=b("router-link"),c=b("router-view"),u=b("babble-modal");return a.currentUser?(s(),l("div",es,[o("div",ts,[o("div",rs,[as,o("div",ss,[(s(!0),l(p,null,h(a.routes,(e=>(s(),l(d,{to:e.path,class:"hover:text-primary hover:bg-blue-50 p-2 xl:px-4 xl:py-2 rounded-full cursor-pointer "+(a.router.currentRoute.value.name==e.name?"text-primary":""),key:e},{default:m((()=>[e.meta.isMenu?(s(),l("div",ls,[o("i",{class:e.icon},null,2),o("span",os,g(e.title),1)])):w("",!0)])),_:2},1032,["to","class"])))),128))]),o("div",is,[o("button",{onClick:t[1]||(t[1]=e=>a.showBabbleModal=!0),class:"mt-3 bg-primary text-white xl:w-full w-12 h-12 rounded-full hover:bg-dark"},[ns,ds])])]),o("div",{class:"xl:pr-3 mb-3 relative",onClick:t[2]||(t[2]=e=>a.showProfileDropdown=!0)},[o("button",cs,["null"!==e.$store.state.user.avatar.slice(-4)?(s(),l("img",{key:0,src:e.$store.state.user.avatar,class:"w-10 h-10 rounded-full"},null,8,["src"])):(s(),l("img",us)),o("div",bs,[o("div",ps,g(a.currentUser.username),1),o("div",hs," @"+g(a.currentUser.nickname),1)]),ms]),o("div",fs,["null"!==e.$store.state.user.avatar.slice(-4)?(s(),l("img",{key:0,src:e.$store.state.user.avatar,class:"w-10 h-10 rounded-full cursor-pointer hover:opacity-80"},null,8,["src"])):(s(),l("img",gs))])])]),o("div",vs,[o(c,{ref:"home"},null,512)]),a.showProfileDropdown?(s(),l("div",{key:0,class:"absolute bottom-20 left-12 shadow rounded-lg w-60 bg-white",onClick:t[4]||(t[4]=e=>a.showProfileDropdown=!1)},[o("button",ys,["null"!==e.$store.state.user.avatar.slice(-4)?(s(),l("img",{key:0,src:e.$store.state.user.avatar,class:"w-10 h-10 rounded-full"},null,8,["src"])):(s(),l("img",xs)),o("div",ws,[o("div",ks,g(a.currentUser.username),1),o("div",Cs," @"+g(a.currentUser.nickname),1)]),Us]),o("button",{class:"p-3 hover:bg-gray-50 w-full text-left text-sm",onClick:t[3]||(t[3]=(...e)=>a.onLogout&&a.onLogout(...e))}," @"+g(a.currentUser.nickname)+" 계정에서 로그아웃 ",1)])):w("",!0),a.showBabbleModal?(s(),l(u,{key:1,onCloseModal:t[5]||(t[5]=e=>a.showBabbleModal=!1)})):w("",!0)])):w("",!0)};const Ms={};Ms.render=function(e,t,r,a,o,i){const n=b("router-view");return s(),l(n)};const As={components:{DefaultLayout:Ja,EmptyLayout:Ms},setup(){const e=U();return{layout:u((()=>e.meta.layout||"DefaultLayout"))}}};As.render=function(e,t,r,a,o,i){return s(),l(E(a.layout))},function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}e.prototype=window.Event.prototype,window.CustomEvent=e}(),function(e){for(var t=e.CustomEvent("freqtimeupdate"),r=function(){this.hasOwnProperty("_interval")||(this._interval=e.setInterval(s.bind(this),100))},a=function(){e.clearInterval(this._interval),delete this._interval},s=function(){this.dispatchEvent(t)},l=e.document.getElementsByTagName("audio"),o=0;o<l.length;o++)l[o].paused||r.call(l[o]),l[o].addEventListener("play",r),l[o].addEventListener("playing",r),l[o].addEventListener("seeked",r),l[o].addEventListener("abort",a),l[o].addEventListener("emptied",a),l[o].addEventListener("ended",a),l[o].addEventListener("pause",a)}(window);const Rs={components:{Layout:As}};Rs.render=function(e,t,r,a,o,i){const n=b("Layout");return s(),l(n)};L(Rs).use(Ka).use(I).mount("#app");
